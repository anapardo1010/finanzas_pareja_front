import{a as W}from"./chunk-MD7C4E5P.js";import{a as j}from"./chunk-MTDW43NY.js";import{A as se,C as S,D,j as ce,m as V,r as A,s as le,v as B}from"./chunk-QWECJNWK.js";import{b as L,c as u,d as R,e as q,h as $,i as de,j as Y,k as G,l as me,m as pe,n as ge,o as fe,p as ue,r as _e,s as U,u as H}from"./chunk-EFCWVEXT.js";import{h as k}from"./chunk-3SXPRKRB.js";import{$a as a,Ka as O,Oa as P,Q as M,V as C,Va as h,Vb as re,W as b,Wa as x,Wb as N,X as oe,Xa as I,Y as ie,Ya as z,Za as d,_a as n,_b as E,a as ne,ab as m,ba as T,fa as _,fb as v,gb as p,hb as s,nb as ae,ob as y,qb as c,rb as f,sb as w,xa as r}from"./chunk-VKFMD7IK.js";function Me(t,i){if(t&1&&(n(0,"div",5)(1,"span",16),c(2,"\u26A0\uFE0F"),a(),n(3,"span"),c(4),a()()),t&2){let e=s();r(4),f(e.error())}}function Pe(t,i){if(t&1&&(n(0,"span",10),c(1),a()),t&2){let e=s();r(),f(e.getErrorMessage("name"))}}function ve(t,i){if(t&1&&(n(0,"span",10),c(1),a()),t&2){let e=s();r(),f(e.getErrorMessage("description"))}}function Oe(t,i){t&1&&(m(0,"span",17),c(1," Guardando... "))}function Ee(t,i){if(t&1&&c(0),t&2){let e=s();w(" ",e.isEditing?"Actualizar":"Crear"," ")}}var K=class t{fb=M(U);categoryService=M(j);authService=M(k);category=null;save=new T;cancel=new T;form;submitting=_(!1);error=_(null);ngOnInit(){this.initForm()}initForm(){this.form=this.fb.group({name:[this.category?.name||"",[u.required,u.minLength(3)]],description:[this.category?.description||"",[u.maxLength(200)]]})}get isEditing(){return this.category!==null}onSubmit(){if(this.form.invalid){this.form.markAllAsTouched();return}let i=this.authService.getTenantId();if(!i){this.error.set("No se pudo obtener el ID del tenant");return}this.submitting.set(!0),this.error.set(null);let e={tenantId:i,name:this.form.value.name,description:this.form.value.description||""};(this.isEditing?this.categoryService.updateCategory(this.category.id,e):this.categoryService.createCategory(e)).subscribe({next:()=>{this.submitting.set(!1),this.save.emit()},error:l=>{this.submitting.set(!1),this.error.set(l.error?.message||"Error al guardar la categor\xEDa")}})}onCancel(){this.cancel.emit()}hasError(i){let e=this.form.get(i);return!!(e&&e.invalid&&(e.dirty||e.touched))}getErrorMessage(i){let e=this.form.get(i);return e?e.hasError("required")?"Este campo es requerido":e.hasError("minlength")?`M\xEDnimo ${e.errors?.minlength.requiredLength} caracteres`:e.hasError("maxlength")?`M\xE1ximo ${e.errors?.maxlength.requiredLength} caracteres`:"":""}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=O({type:t,selectors:[["app-category-form"]],inputs:{category:"category"},outputs:{save:"save",cancel:"cancel"},decls:28,vars:12,consts:[[1,"modal-overlay",3,"click"],[1,"modal-content","glass-modal",3,"click"],[1,"modal-header"],["title","Cerrar",1,"btn-close",3,"click"],[3,"ngSubmit","formGroup"],[1,"alert","alert-error"],[1,"form-group"],["for","name",1,"form-label"],[1,"required"],["type","text","id","name","formControlName","name","placeholder","Ej: Comida, Transporte, Entretenimiento","autocomplete","off",1,"form-input"],[1,"error-message"],["for","description",1,"form-label"],["id","description","formControlName","description","placeholder","Descripci\xF3n opcional de la categor\xEDa","rows","3",1,"form-textarea"],[1,"modal-actions"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"alert-icon"],[1,"spinner-small"]],template:function(e,o){e&1&&(n(0,"div",0),p("click",function(){return o.onCancel()}),n(1,"div",1),p("click",function(g){return g.stopPropagation()}),n(2,"header",2)(3,"h2"),c(4),a(),n(5,"button",3),p("click",function(){return o.onCancel()}),n(6,"span"),c(7,"\u2715"),a()()(),n(8,"form",4),p("ngSubmit",function(){return o.onSubmit()}),h(9,Me,5,1,"div",5),n(10,"div",6)(11,"label",7),c(12," Nombre "),n(13,"span",8),c(14,"*"),a()(),m(15,"input",9),h(16,Pe,2,1,"span",10),a(),n(17,"div",6)(18,"label",11),c(19," Descripci\xF3n "),a(),m(20,"textarea",12),h(21,ve,2,1,"span",10),a(),n(22,"div",13)(23,"button",14),p("click",function(){return o.onCancel()}),c(24," Cancelar "),a(),n(25,"button",15),h(26,Oe,2,0)(27,Ee,1,1),a()()()()()),e&2&&(r(4),f(o.isEditing?"Editar Categor\xEDa":"Nueva Categor\xEDa"),r(4),d("formGroup",o.form),r(),x(o.error()?9:-1),r(6),y("error",o.hasError("name")),r(),x(o.hasError("name")?16:-1),r(4),y("error",o.hasError("description")),r(),x(o.hasError("description")?21:-1),r(2),d("disabled",o.submitting()),r(2),d("disabled",o.submitting()||o.form.invalid),r(),x(o.submitting()?26:27))},dependencies:[E,H,$,L,R,q,G,Y],styles:[".modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);display:flex;align-items:center;justify-content:center;z-index:1000;animation:_ngcontent-%COMP%_fadeIn .3s ease-out;padding:1rem}.modal-content[_ngcontent-%COMP%]{width:100%;max-width:500px;background:#fff;border-radius:20px;box-shadow:0 20px 60px #0000004d,0 4px 16px #0000001a;animation:_ngcontent-%COMP%_slideUp .3s cubic-bezier(.4,0,.2,1);overflow:hidden}.glass-modal[_ngcontent-%COMP%]{background:#fffffff2;backdrop-filter:blur(40px);-webkit-backdrop-filter:blur(40px);border:1px solid rgba(255,255,255,.18)}.modal-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1.5rem 2rem;border-bottom:1px solid rgba(0,0,0,.06)}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;color:#1d1d1f;margin:0;letter-spacing:-.02em}.modal-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{width:32px;height:32px;display:flex;align-items:center;justify-content:center;background:#0000000a;border:none;border-radius:8px;cursor:pointer;transition:all .2s ease;font-size:1.25rem;color:#6e6e73}.modal-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]:hover{background:#00000014;color:#1d1d1f}.modal-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]:active{transform:scale(.95)}form[_ngcontent-%COMP%]{padding:2rem}.alert[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:1rem 1.25rem;border-radius:12px;margin-bottom:1.5rem;font-size:.9375rem}.alert.alert-error[_ngcontent-%COMP%]{background:#ff3b301a;color:#ff3b30;border:1px solid rgba(255,59,48,.2)}.alert[_ngcontent-%COMP%]   .alert-icon[_ngcontent-%COMP%]{font-size:1.25rem}.form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-group[_ngcontent-%COMP%]:last-of-type{margin-bottom:0}.form-label[_ngcontent-%COMP%]{display:block;font-size:.9375rem;font-weight:600;color:#1d1d1f;margin-bottom:.5rem}.form-label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:#ff3b30;margin-left:.25rem}.form-input[_ngcontent-%COMP%], .form-textarea[_ngcontent-%COMP%]{width:100%;padding:.875rem 1rem;font-size:.9375rem;color:#1d1d1f;background:#f5f5f7;border:2px solid rgba(0,0,0,.06);border-radius:12px;transition:all .2s ease;font-family:inherit;outline:none}.form-input[_ngcontent-%COMP%]::placeholder, .form-textarea[_ngcontent-%COMP%]::placeholder{color:#8e8e93}.form-input[_ngcontent-%COMP%]:focus, .form-textarea[_ngcontent-%COMP%]:focus{border-color:#007aff;background:#fff;box-shadow:0 0 0 4px #007aff1a}.form-input.error[_ngcontent-%COMP%], .form-textarea.error[_ngcontent-%COMP%]{border-color:#ff3b30}.form-input.error[_ngcontent-%COMP%]:focus, .form-textarea.error[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 4px #ff3b301a}.form-input[_ngcontent-%COMP%]:disabled, .form-textarea[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.form-textarea[_ngcontent-%COMP%]{resize:vertical;min-height:80px;font-family:inherit}.error-message[_ngcontent-%COMP%]{display:block;font-size:.8125rem;color:#ff3b30;margin-top:.375rem;font-weight:500}.modal-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;padding-top:1.5rem;margin-top:1.5rem;border-top:1px solid rgba(0,0,0,.06)}.btn[_ngcontent-%COMP%]{flex:1;padding:.875rem 1.5rem;font-size:.9375rem;font-weight:600;border:none;border-radius:12px;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;justify-content:center;gap:.5rem}.btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn[_ngcontent-%COMP%]:not(:disabled):active{transform:scale(.98)}.btn-secondary[_ngcontent-%COMP%]{background:#0000000a;color:#1d1d1f}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#00000014}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#007aff,#0051d5);color:#fff;box-shadow:0 4px 12px #007aff4d}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 6px 20px #007aff66;transform:translateY(-2px)}.btn-primary[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}.spinner-small[_ngcontent-%COMP%]{width:16px;height:16px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .6s linear infinite}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}@media(max-width:768px){.modal-content[_ngcontent-%COMP%]{max-width:calc(100% - 2rem)}.modal-header[_ngcontent-%COMP%]{padding:1.25rem 1.5rem}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem}form[_ngcontent-%COMP%]{padding:1.5rem}.modal-actions[_ngcontent-%COMP%]{flex-direction:column}.modal-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}}"]})};var we=(t,i)=>i.id;function ke(t,i){t&1&&(n(0,"div",1),m(1,"div",6),n(2,"p"),c(3,"Cargando categor\xEDas..."),a()())}function Te(t,i){if(t&1){let e=v();n(0,"div",2),m(1,"lucide-icon",7),n(2,"h3"),c(3,"Sin categor\xEDas"),a(),n(4,"p"),c(5,"Crea tu primera categor\xEDa para organizar tus transacciones"),a(),n(6,"button",8),p("click",function(){C(e);let l=s();return b(l.openCreateForm())}),m(7,"lucide-icon",7),c(8," Crear Categor\xEDa "),a()()}if(t&2){let e=s();r(),d("img",e.Folder)("size",48),r(6),d("img",e.Plus)("size",18)}}function Se(t,i){if(t&1){let e=v();n(0,"div",9)(1,"div",10)(2,"div",11)(3,"h3",12),c(4),a(),n(5,"p",13),c(6),a()(),n(7,"div",14)(8,"span",15),c(9),a()()(),n(10,"div",16)(11,"button",17),p("click",function(){let l=C(e).$implicit,g=s(2);return b(g.editCategory(l))}),m(12,"lucide-icon",7),a(),n(13,"button",18),p("click",function(){let l=C(e).$implicit,g=s(2);return b(g.deleteCategory(l))}),m(14,"lucide-icon",7),a()()()}if(t&2){let e=i.$implicit,o=s(2);r(4),f(e.name),r(2),f(e.description||"Sin descripci\xF3n"),r(2),y("active",e.isActive),r(),w(" ",e.isActive?"Activa":"Inactiva"," "),r(3),d("img",o.Edit2)("size",16),r(2),d("img",o.Trash2)("size",16)}}function De(t,i){if(t&1&&(n(0,"div",3),I(1,Se,15,9,"div",9,we),a()),t&2){let e=s();r(),z(e.categories())}}function Fe(t,i){if(t&1){let e=v();n(0,"button",19),p("click",function(){C(e);let l=s();return b(l.openCreateForm())}),m(1,"lucide-icon",7),a()}if(t&2){let e=s();r(),d("img",e.Plus)("size",20)}}function Ie(t,i){if(t&1){let e=v();n(0,"app-category-form",20),p("save",function(){C(e);let l=s();return b(l.handleFormSave())})("cancel",function(){C(e);let l=s();return b(l.closeForm())}),a()}if(t&2){let e=s();d("category",e.selectedCategory())}}var Q=class t{categoryService=M(j);authService=M(k);Folder=V;Edit2=A;Trash2=B;Plus=le;categories=_([]);loading=_(!1);showForm=_(!1);selectedCategory=_(null);ngOnInit(){console.log("CategoriesTab inicializado"),console.log("TenantId:",this.authService.getTenantId()),console.log("Usuario:",this.authService.currentUser()),this.loadCategories()}loadCategories(){let i=this.authService.getTenantId();if(console.log("Cargando categor\xEDas para tenantId:",i),!i){console.error("No hay tenantId - usuario no autenticado?"),this.loading.set(!1);return}this.loading.set(!0),this.categoryService.getByTenant(i,0,50).subscribe({next:e=>{console.log("Categor\xEDas cargadas:",e),this.categories.set(e.content),this.loading.set(!1)},error:e=>{console.error("Error loading categories:",e),this.loading.set(!1)}})}openCreateForm(){console.log("Abriendo formulario de categor\xEDa"),this.selectedCategory.set(null),this.showForm.set(!0),console.log("showForm:",this.showForm())}editCategory(i){this.selectedCategory.set(i),this.showForm.set(!0)}deleteCategory(i){confirm(`\xBFEliminar la categor\xEDa "${i.name}"?`)&&this.categoryService.deleteCategory(i.id).subscribe({next:()=>{this.loadCategories()},error:e=>{console.error("Error deleting category:",e)}})}handleFormSave(){this.showForm.set(!1),this.loadCategories()}closeForm(){this.showForm.set(!1),this.selectedCategory.set(null)}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=O({type:t,selectors:[["app-categories-tab"]],decls:6,vars:3,consts:[[1,"categories-tab-compact"],[1,"loading-container"],[1,"empty-state"],[1,"categories-grid-compact"],["title","Crear categor\xEDa",1,"fab-compact"],[3,"category"],[1,"spinner"],[3,"img","size"],[1,"btn-primary",3,"click"],[1,"category-card-compact"],[1,"card-content"],[1,"category-info"],[1,"category-name"],[1,"category-description"],[1,"card-footer"],[1,"badge"],[1,"category-actions"],["title","Editar",1,"btn-icon-compact",3,"click"],["title","Eliminar",1,"btn-icon-compact","delete",3,"click"],["title","Crear categor\xEDa",1,"fab-compact",3,"click"],[3,"save","cancel","category"]],template:function(e,o){e&1&&(n(0,"div",0),h(1,ke,4,0,"div",1)(2,Te,9,4,"div",2)(3,De,3,0,"div",3),h(4,Fe,2,2,"button",4),h(5,Ie,1,1,"app-category-form",5),a()),e&2&&(r(),x(o.loading()?1:o.categories().length===0?2:3),r(3),x(o.categories().length>0&&!o.loading()?4:-1),r(),x(o.showForm()?5:-1))},dependencies:[E,K,D,S],styles:[".categories-tab-compact[_ngcontent-%COMP%]{position:relative;min-height:300px}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;color:#6e6e73}.loading-container[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:3px solid rgba(0,122,255,.1);border-top-color:#007aff;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:12px;font-size:14px}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;text-align:center}.empty-state[_ngcontent-%COMP%]   lucide-icon[_ngcontent-%COMP%]{color:#8e8e93;margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#1d1d1f;margin:0 0 8px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;color:#6e6e73;margin:0 0 24px;max-width:400px}.empty-state[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:8px;padding:10px 20px;background:linear-gradient(135deg,#007aff,#0051d5);color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:600;cursor:pointer;transition:all .2s ease}.empty-state[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 12px #007aff4d}.categories-grid-compact[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:12px;animation:_ngcontent-%COMP%_fadeIn .3s ease-out}.category-card-compact[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:16px;background:#f5f5f7;border-radius:10px;border:1px solid rgba(0,0,0,.08);transition:all .2s ease}.category-card-compact[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #00000014}.category-card-compact[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{flex:1;min-width:0}.category-card-compact[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]{margin-bottom:8px}.category-card-compact[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-name[_ngcontent-%COMP%]{font-size:15px;font-weight:600;color:#1d1d1f;margin:0 0 4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.category-card-compact[_ngcontent-%COMP%]   .category-info[_ngcontent-%COMP%]   .category-description[_ngcontent-%COMP%]{font-size:13px;color:#6e6e73;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.category-card-compact[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:4px 10px;background:#8e8e931f;color:#6e6e73;border-radius:6px;font-size:12px;font-weight:600}.category-card-compact[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .badge.active[_ngcontent-%COMP%]{background:#34c75926;color:#34c759}.category-card-compact[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]{display:flex;gap:6px;margin-left:12px}.category-card-compact[_ngcontent-%COMP%]   .btn-icon-compact[_ngcontent-%COMP%]{width:32px;height:32px;display:flex;align-items:center;justify-content:center;background:transparent;border:1px solid rgba(0,0,0,.08);border-radius:8px;cursor:pointer;transition:all .2s ease;color:#6e6e73}.category-card-compact[_ngcontent-%COMP%]   .btn-icon-compact[_ngcontent-%COMP%]:hover{background:#eaeaea;border-color:#007aff;color:#007aff}.category-card-compact[_ngcontent-%COMP%]   .btn-icon-compact.delete[_ngcontent-%COMP%]:hover{border-color:#ff3b30;color:#ff3b30;background:#ff3b301a}.fab-compact[_ngcontent-%COMP%]{bottom:2rem;right:2rem;width:64px;height:64px;position:fixed;bottom:24px;right:24px;width:56px;height:56px;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#007aff,#0051d5);color:#fff;border:none;border-radius:50%;box-shadow:0 4px 12px #007aff4d;cursor:pointer;transition:all .2s ease;z-index:100}.fab-compact[_ngcontent-%COMP%]:hover{transform:scale(1.1);box-shadow:0 6px 16px #007aff66}.fab-compact[_ngcontent-%COMP%]:active{transform:scale(1.05)}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}@media(max-width:768px){.categories-grid-compact[_ngcontent-%COMP%]{grid-template-columns:1fr}.fab-compact[_ngcontent-%COMP%]{bottom:16px;right:16px;width:48px;height:48px}}"]})};function Ne(t,i){if(t&1&&(n(0,"div",24)(1,"span",25),c(2,"\u26A0\uFE0F"),a(),n(3,"span"),c(4),a()()),t&2){let e=s();r(4),f(e.error())}}function Ve(t,i){if(t&1&&(n(0,"option",26),c(1),a()),t&2){let e=i.$implicit;d("value",e.value),r(),f(e.label)}}function Ae(t,i){if(t&1&&(n(0,"span",27),c(1),a()),t&2){let e=s();r(),f(e.getErrorMessage("accountType"))}}function Be(t,i){if(t&1&&(n(0,"span",27),c(1),a()),t&2){let e=s();r(),f(e.getErrorMessage("alias"))}}function je(t,i){if(t&1&&(n(0,"option",26),c(1),a()),t&2){let e=i.$implicit;d("value",e.value),r(),f(e.name)}}function Le(t,i){if(t&1&&(n(0,"span",27),c(1),a()),t&2){let e=s(2);r(),f(e.getErrorMessage("bankName"))}}function Re(t,i){if(t&1&&(n(0,"div",6)(1,"label",28),c(2," Banco "),n(3,"span",8),c(4,"*"),a()(),n(5,"select",29)(6,"option",30),c(7,"Selecciona un banco"),a(),P(8,je,2,2,"option",10),a(),P(9,Le,2,1,"span",11),a()),t&2){let e=s();r(5),y("error",e.hasError("bankName")),r(3),d("ngForOf",e.banksList),r(),d("ngIf",e.hasError("bankName"))}}function qe(t,i){if(t&1&&(n(0,"span",27),c(1),a()),t&2){let e=s(2);r(),f(e.getErrorMessage("cutDay"))}}function $e(t,i){if(t&1&&(n(0,"span",27),c(1),a()),t&2){let e=s(2);r(),f(e.getErrorMessage("paymentDay"))}}function Ye(t,i){if(t&1&&(n(0,"div",31)(1,"div",6)(2,"label",32),c(3," D\xEDa de Corte "),n(4,"span",8),c(5,"*"),a()(),m(6,"input",33),P(7,qe,2,1,"span",11),a(),n(8,"div",6)(9,"label",34),c(10," D\xEDa de Pago "),n(11,"span",8),c(12,"*"),a()(),m(13,"input",35),P(14,$e,2,1,"span",11),a()()),t&2){let e=s();r(6),y("error",e.hasError("cutDay")),r(),d("ngIf",e.hasError("cutDay")),r(6),y("error",e.hasError("paymentDay")),r(),d("ngIf",e.hasError("paymentDay"))}}function Ge(t,i){t&1&&m(0,"span",36)}var Z=class t{fb=M(U);paymentMethodService=M(W);authService=M(k);paymentMethod=null;save=new T;cancel=new T;form;submitting=_(!1);error=_(null);banks=[];accountTypes=[{value:"CASH",label:"Efectivo"},{value:"DEBIT",label:"D\xE9bito"},{value:"CREDIT",label:"Cr\xE9dito"}];defaultBanks=[{name:"BBVA M\xE9xico",value:"BBVA",color:"rgb(0,68,129)"},{name:"Banorte",value:"Banorte",color:"rgb(235,0,45)"},{name:"Santander",value:"Santander",color:"rgb(236,0,0)"},{name:"Citibanamex",value:"Citibanamex",color:"rgb(0,45,114)"},{name:"HSBC",value:"HSBC",color:"rgb(219,0,11)"},{name:"Scotiabank",value:"Scotiabank",color:"rgb(237,7,18)"},{name:"Banco Azteca",value:"Banco Azteca",color:"rgb(0,106,77)"},{name:"Banregio",value:"Banregio",color:"rgb(255,102,0)"},{name:"Nu M\xE9xico",value:"Nu",color:"rgb(130,10,209)"},{name:"Stori",value:"Stori",color:"rgb(200,255,0)"},{name:"RappiCard",value:"RappiCard",color:"rgb(255,80,75)"},{name:"Mercado Pago",value:"Mercado Pago",color:"rgb(0,158,227)"},{name:"Ual\xE1",value:"Ual\xE1",color:"rgb(0,122,255)"},{name:"Vexi",value:"Vexi",color:"rgb(0,199,179)"},{name:"Fondeadora",value:"Fondeadora",color:"rgb(0,0,0)"},{name:"Uber Pro Card",value:"Uber",color:"rgb(0,0,0)"},{name:"Didi Card",value:"Didi",color:"rgb(255,122,0)"},{name:"Spin by OXXO",value:"Spin",color:"rgb(110,35,130)"},{name:"Klar",value:"Klar",color:"rgb(16,24,32)"}];get banksList(){return this.banks.length>0?this.banks:this.defaultBanks}ngOnInit(){this.initForm(),this.setupAccountTypeListener()}initForm(){let i=this.paymentMethod?.accountType||"CASH";this.form=this.fb.group({accountType:[i,[u.required]],alias:[this.paymentMethod?.alias||"",[u.maxLength(50)]],bankName:[this.paymentMethod?.bankName||"",i==="DEBIT"||i==="CREDIT"?[u.required]:[]],cutDay:[{value:this.paymentMethod?.cutDay||1,disabled:i!=="CREDIT"},i==="CREDIT"?[u.required,u.min(1),u.max(31)]:[]],paymentDay:[{value:this.paymentMethod?.paymentDay||1,disabled:i!=="CREDIT"},i==="CREDIT"?[u.required,u.min(1),u.max(31)]:[]]})}setupAccountTypeListener(){this.form.get("accountType")?.valueChanges.subscribe(i=>{let e=this.form.get("bankName"),o=this.form.get("cutDay"),l=this.form.get("paymentDay");i==="DEBIT"||i==="CREDIT"?(e?.setValidators([u.required]),e?.enable()):(e?.clearValidators(),e?.setValue(""),e?.disable()),e?.updateValueAndValidity(),i==="CREDIT"?(o?.enable(),l?.enable(),o?.setValidators([u.required,u.min(1),u.max(31)]),l?.setValidators([u.required,u.min(1),u.max(31)])):(o?.disable(),l?.disable(),o?.clearValidators(),l?.clearValidators(),o?.setValue(null),l?.setValue(null)),o?.updateValueAndValidity(),l?.updateValueAndValidity()})}get isCreditCard(){return this.form.get("accountType")?.value==="CREDIT"}get isEditing(){return this.paymentMethod!==null}onSubmit(){if(this.form.invalid){this.form.markAllAsTouched();return}let e=this.authService.currentUser()?.id;if(!e){this.error.set("No se pudo obtener el ID del usuario");return}this.submitting.set(!0),this.error.set(null);let o=this.form.value.accountType,l=o==="CREDIT",F={userId:e,bankName:o==="DEBIT"||l?this.form.value.bankName:"Efectivo",accountType:o,cutDay:l?parseInt(this.form.get("cutDay")?.value):1,paymentDay:l?parseInt(this.form.get("paymentDay")?.value):1,alias:this.form.value.alias||void 0};(this.isEditing?this.paymentMethodService.updatePaymentMethod(this.paymentMethod.id,F):this.paymentMethodService.createPaymentMethod(F)).subscribe({next:()=>{this.submitting.set(!1),this.save.emit()},error:te=>{this.submitting.set(!1),this.error.set(te.error?.message||"Error al guardar el m\xE9todo de pago")}})}onCancel(){this.cancel.emit()}hasError(i){let e=this.form.get(i);return!!(e&&e.invalid&&(e.dirty||e.touched))}getErrorMessage(i){let e=this.form.get(i);return e?e.hasError("required")?"Este campo es requerido":e.hasError("min")?`Valor m\xEDnimo: ${e.errors?.min.min}`:e.hasError("max")?`Valor m\xE1ximo: ${e.errors?.max.max}`:e.hasError("maxlength")?`M\xE1ximo ${e.errors?.maxlength.requiredLength} caracteres`:"":""}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=O({type:t,selectors:[["app-payment-method-form"]],inputs:{paymentMethod:"paymentMethod",banks:"banks"},outputs:{save:"save",cancel:"cancel"},decls:39,vars:16,consts:[[1,"modal-overlay",3,"click"],[1,"modal-content","glass-modal",3,"click"],[1,"modal-header"],["title","Cerrar",1,"btn-close",3,"click"],[3,"ngSubmit","formGroup"],["class","alert alert-error",4,"ngIf"],[1,"form-group"],["for","accountType",1,"form-label"],[1,"required"],["id","accountType","formControlName","accountType",1,"form-select"],[3,"value",4,"ngFor","ngForOf"],["class","error-message",4,"ngIf"],["for","alias",1,"form-label"],[1,"optional"],["type","text","id","alias","formControlName","alias","placeholder","ej: Visa personal, Tarjeta n\xF3mina, Efectivo oficina","maxlength","50",1,"form-input"],[1,"form-hint"],["class","form-group",4,"ngIf"],["class","form-row",4,"ngIf"],[1,"info-note"],[1,"info-icon"],[1,"modal-actions"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","spinner-small",4,"ngIf"],[1,"alert","alert-error"],[1,"alert-icon"],[3,"value"],[1,"error-message"],["for","bankName",1,"form-label"],["id","bankName","formControlName","bankName",1,"form-select"],["value","","disabled",""],[1,"form-row"],["for","cutDay",1,"form-label"],["type","number","id","cutDay","formControlName","cutDay","placeholder","1-31","min","1","max","31",1,"form-input"],["for","paymentDay",1,"form-label"],["type","number","id","paymentDay","formControlName","paymentDay","placeholder","1-31","min","1","max","31",1,"form-input"],[1,"spinner-small"]],template:function(e,o){if(e&1&&(n(0,"div",0),p("click",function(){return o.onCancel()}),n(1,"div",1),p("click",function(g){return g.stopPropagation()}),n(2,"header",2)(3,"h2"),c(4),a(),n(5,"button",3),p("click",function(){return o.onCancel()}),n(6,"span"),c(7,"\u2715"),a()()(),n(8,"form",4),p("ngSubmit",function(){return o.onSubmit()}),P(9,Ne,5,1,"div",5),n(10,"div",6)(11,"label",7),c(12," Tipo de Cuenta "),n(13,"span",8),c(14,"*"),a()(),n(15,"select",9),P(16,Ve,2,2,"option",10),a(),P(17,Ae,2,1,"span",11),a(),n(18,"div",6)(19,"label",12),c(20," Alias "),n(21,"span",13),c(22,"(opcional)"),a()(),m(23,"input",14),n(24,"small",15),c(25,"Dale un nombre personalizado para identificarla f\xE1cilmente"),a(),P(26,Be,2,1,"span",11),a(),P(27,Re,10,4,"div",16)(28,Ye,15,6,"div",17),n(29,"div",18),m(30,"span",19),n(31,"p"),c(32,"Los d\xEDas de corte y pago son importantes para calcular tus per\xEDodos de facturaci\xF3n y MSI."),a()(),n(33,"div",20)(34,"button",21),p("click",function(){return o.onCancel()}),c(35," Cancelar "),a(),n(36,"button",22),P(37,Ge,1,0,"span",23),c(38),a()()()()()),e&2){let l,g;r(4),f(o.isEditing?"Editar Tarjeta":"Nueva Tarjeta"),r(4),d("formGroup",o.form),r(),d("ngIf",o.error()),r(6),y("error",o.hasError("accountType")),r(),d("ngForOf",o.accountTypes),r(),d("ngIf",o.hasError("accountType")),r(6),y("error",o.hasError("alias")),r(3),d("ngIf",o.hasError("alias")),r(),d("ngIf",((l=o.form.get("accountType"))==null?null:l.value)==="DEBIT"||((l=o.form.get("accountType"))==null?null:l.value)==="CREDIT"),r(),d("ngIf",((g=o.form.get("accountType"))==null?null:g.value)==="CREDIT"),r(6),d("disabled",o.submitting()),r(2),d("disabled",o.submitting()||o.form.invalid),r(),d("ngIf",o.submitting()),r(),w(" ",o.isEditing?"Actualizar":"Crear"," ")}},dependencies:[E,re,N,H,$,pe,ge,L,de,me,R,q,_e,ue,fe,G,Y],styles:[`.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);display:flex;align-items:center;justify-content:center;z-index:1000;animation:_ngcontent-%COMP%_fadeIn .3s ease-out;padding:1rem}.modal-content[_ngcontent-%COMP%]{width:100%;max-width:500px;background:#fff;border-radius:20px;box-shadow:0 20px 60px #0000004d,0 4px 16px #0000001a;animation:_ngcontent-%COMP%_slideUp .3s cubic-bezier(.4,0,.2,1);overflow:hidden;padding:20px}.glass-modal[_ngcontent-%COMP%]{background:#fffffff2;backdrop-filter:blur(40px);-webkit-backdrop-filter:blur(40px);border:1px solid rgba(255,255,255,.18)}.modal-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1.5rem 2rem;border-bottom:1px solid rgba(0,0,0,.06)}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;color:#1d1d1f;margin:0;letter-spacing:-.02em}.modal-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{width:32px;height:32px;display:flex;align-items:center;justify-content:center;background:#0000000a;border:none;border-radius:8px;cursor:pointer;transition:all .2s ease;font-size:1.25rem;color:#6e6e73}.modal-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]:hover{background:#00000014;color:#1d1d1f}.modal-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]:active{transform:scale(.95)}form[_ngcontent-%COMP%]{padding:2rem}.alert[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:1rem 1.25rem;border-radius:12px;margin-bottom:1.5rem;font-size:.9375rem}.alert.alert-error[_ngcontent-%COMP%]{background:#ff3b301a;color:#ff3b30;border:1px solid rgba(255,59,48,.2)}.alert[_ngcontent-%COMP%]   .alert-icon[_ngcontent-%COMP%]{font-size:1.25rem}.form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.form-group[_ngcontent-%COMP%]:last-of-type{margin-bottom:0}.form-group[_ngcontent-%COMP%]{margin-bottom:10px}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem}.form-label[_ngcontent-%COMP%]{display:block;font-size:.9375rem;font-weight:600;color:#1d1d1f;margin-bottom:.5rem}.form-label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:#ff3b30;margin-left:.25rem}.form-label[_ngcontent-%COMP%]   .optional[_ngcontent-%COMP%]{font-weight:400;color:#6e6e73;font-size:.875rem;margin-left:.25rem}.form-input[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{width:100%;padding:.875rem 1rem;font-size:.9375rem;color:#1d1d1f;background:#f5f5f7;border:2px solid rgba(0,0,0,.06);border-radius:12px;transition:all .2s ease;font-family:inherit;outline:none}.form-input[_ngcontent-%COMP%]::placeholder, .form-select[_ngcontent-%COMP%]::placeholder{color:#8e8e93}.form-input[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{border-color:#007aff;background:#fff;box-shadow:0 0 0 4px #007aff1a}.form-input.error[_ngcontent-%COMP%], .form-select.error[_ngcontent-%COMP%]{border-color:#ff3b30}.form-input.error[_ngcontent-%COMP%]:focus, .form-select.error[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 4px #ff3b301a}.form-input[_ngcontent-%COMP%]:disabled, .form-select[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.form-select[_ngcontent-%COMP%]{cursor:pointer;appearance:none;background-image:url("data:image/svg+xml,%3Csvg width='12' height='8' viewBox='0 0 12 8' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1.5L6 6.5L11 1.5' stroke='%23666' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 1rem center;padding-right:3rem}.error-message[_ngcontent-%COMP%]{display:block;font-size:.8125rem;color:#ff3b30;margin-top:.375rem;font-weight:500}.form-hint[_ngcontent-%COMP%]{display:block;font-size:.8125rem;color:#6e6e73;margin-top:.375rem;font-style:italic}.info-note[_ngcontent-%COMP%]{display:flex;gap:.75rem;padding:1rem 1.25rem;background:#007aff14;border-radius:12px;margin-top:1.5rem}.info-note[_ngcontent-%COMP%]   .info-icon[_ngcontent-%COMP%]{font-size:1.25rem;flex-shrink:0}.info-note[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.875rem;color:#6e6e73;margin:0;line-height:1.5}.modal-actions[_ngcontent-%COMP%]{gap:1rem;padding-top:1.5rem;margin-top:1.5rem;border-top:1px solid rgba(0,0,0,.06);display:flex;justify-content:space-between;margin-top:15px}.btn[_ngcontent-%COMP%]{flex:1;padding:.875rem 1.5rem;font-size:.9375rem;font-weight:600;border:none;border-radius:12px;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;justify-content:center;gap:.5rem}.btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn[_ngcontent-%COMP%]:not(:disabled):active{transform:scale(.98)}.btn-secondary[_ngcontent-%COMP%]{background:#0000000a;color:#1d1d1f}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#00000014}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#007aff,#0051d5);color:#fff;box-shadow:0 4px 12px #007aff4d}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){box-shadow:0 6px 20px #007aff66;transform:translateY(-2px)}.btn-primary[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}.spinner-small[_ngcontent-%COMP%]{width:16px;height:16px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .6s linear infinite}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}@media(max-width:768px){.modal-content[_ngcontent-%COMP%]{max-width:calc(100% - 2rem)}.modal-header[_ngcontent-%COMP%]{padding:1.25rem 1.5rem}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.25rem}form[_ngcontent-%COMP%]{padding:1.5rem}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-actions[_ngcontent-%COMP%]{flex-direction:column}.modal-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}}`]})};var Ue=(t,i)=>i.id;function He(t,i){t&1&&(n(0,"div",1),m(1,"div",6),n(2,"p"),c(3,"Cargando tarjetas..."),a()())}function We(t,i){if(t&1){let e=v();n(0,"div",2)(1,"div",7),c(2,"\u{1F4B3}"),a(),n(3,"h3"),c(4,"Sin tarjetas registradas"),a(),n(5,"p"),c(6,"Agrega tus tarjetas bancarias para gestionar tus pagos"),a(),n(7,"div",8)(8,"button",9),p("click",function(){C(e);let l=s();return b(l.openCreateForm())}),n(9,"span",10),c(10,"+"),a(),c(11," Agregar Tarjeta "),a(),n(12,"button",11),p("click",function(){C(e);let l=s();return b(l.createPredefinedOptions())}),n(13,"span",10),c(14,"\u26A1"),a(),c(15," Opciones Predefinidas "),a()()()}}function Ke(t,i){if(t&1&&(n(0,"div",26),c(1),a()),t&2){let e=s(2).$implicit;r(),f(e.alias)}}function Xe(t,i){if(t&1&&(n(0,"div",34)(1,"div",35)(2,"div",36)(3,"span",37),c(4,"Corte"),a(),n(5,"span",38),c(6),a()(),n(7,"div",36)(8,"span",37),c(9,"Pago"),a(),n(10,"span",38),c(11),a()()()()),t&2){let e=s(2).$implicit;r(6),w("D\xEDa ",e.cutDay),r(5),w("D\xEDa ",e.paymentDay)}}function Je(t,i){if(t&1){let e=v();n(0,"div",14)(1,"div",15),oe(),n(2,"svg",16),m(3,"rect",17),n(4,"defs")(5,"linearGradient",18),m(6,"stop",19)(7,"stop",20),a()()()(),ie(),n(8,"div",21)(9,"button",22),p("click",function(){C(e);let l=s().$implicit,g=s(2);return b(g.editPaymentMethod(l))}),m(10,"lucide-icon",23),a(),n(11,"button",24),p("click",function(){C(e);let l=s().$implicit,g=s(2);return b(g.deletePaymentMethod(l))}),n(12,"span"),c(13,"\u{1F5D1}\uFE0F"),a()()(),n(14,"div",25),h(15,Ke,2,1,"div",26),n(16,"div",27),c(17,"\u2022\u2022\u2022\u2022 \u2022\u2022\u2022\u2022 \u2022\u2022\u2022\u2022 \u2022\u2022\u2022\u2022"),a(),n(18,"div",28)(19,"div",29)(20,"span",30),c(21,"Banco"),a(),n(22,"span",31),c(23),a()(),n(24,"div",32)(25,"span",30),c(26,"Tipo"),a(),n(27,"span",31),c(28),a()()()(),P(29,Xe,12,2,"div",33),a()}if(t&2){let e=s().$implicit,o=s(2);ae("background",o.getBankColor(e.bankName)),r(10),d("img",o.Edit2)("size",16),r(5),x(e.alias?15:-1),r(8),f(e.bankName),r(5),f(e.accountType),r(),d("ngIf",e.accountType==="CREDIT")}}function Qe(t,i){if(t&1){let e=v();n(0,"div",39)(1,"div",40),m(2,"lucide-icon",23),a(),n(3,"div",41)(4,"h4",42),c(5),a(),n(6,"p",43),c(7," Para fines pr\xE1cticos, este monedero virtual representa el efectivo f\xEDsico que tienes. "),a()(),n(8,"div",21)(9,"button",22),p("click",function(){C(e);let l=s().$implicit,g=s(2);return b(g.editPaymentMethod(l))}),m(10,"lucide-icon",23),a(),n(11,"button",24),p("click",function(){C(e);let l=s().$implicit,g=s(2);return b(g.deletePaymentMethod(l))}),m(12,"lucide-icon",23),a()()()}if(t&2){let e=s().$implicit,o=s(2);r(2),d("img",o.Wallet)("size",32),r(3),f(e.alias||"Efectivo"),r(5),d("img",o.Edit2)("size",16),r(2),d("img",o.Trash2)("size",16)}}function Ze(t,i){if(t&1&&P(0,Je,30,8,"div",12)(1,Qe,13,7,"div",13),t&2){let e=i.$implicit;d("ngIf",e.accountType!=="CASH"),r(),d("ngIf",e.accountType==="CASH")}}function et(t,i){if(t&1&&(n(0,"div",3),I(1,Ze,2,2,null,null,Ue),a()),t&2){let e=s();r(),z(e.paymentMethods())}}function tt(t,i){if(t&1){let e=v();n(0,"button",44),p("click",function(){C(e);let l=s();return b(l.openCreateForm())}),n(1,"span",45),c(2,"+"),a()()}}function nt(t,i){if(t&1){let e=v();n(0,"app-payment-method-form",46),p("save",function(){C(e);let l=s();return b(l.handleFormSave())})("cancel",function(){C(e);let l=s();return b(l.closeForm())}),a()}if(t&2){let e=s();d("paymentMethod",e.selectedPaymentMethod())}}var ee=class t{Edit2=A;Wallet=se;Trash2=B;paymentMethodService=M(W);authService=M(k);paymentMethods=_([]);loading=_(!1);showForm=_(!1);selectedPaymentMethod=_(null);ngOnInit(){this.loadPaymentMethods()}loadPaymentMethods(){let i=this.authService.getTenantId();if(console.log("\u{1F50D} TenantId para payment methods:",i),!i){console.error("\u274C No hay tenantId");return}this.loading.set(!0),console.log("\u{1F504} Cargando payment methods..."),this.paymentMethodService.getByTenant(i,0,50).subscribe({next:e=>{console.log("\u2705 Payment methods cargados:",e),this.paymentMethods.set(e.content),this.loading.set(!1)},error:e=>{console.error("\u274C Error loading payment methods:",e),this.loading.set(!1)}})}openCreateForm(){this.selectedPaymentMethod.set(null),this.showForm.set(!0)}createPredefinedOptions(){let i=this.authService.currentUser()?.id,e=this.authService.getTenantId();if(!i||!e){console.error("\u274C No hay userId o tenantId");return}let o=[{bankName:"Efectivo",accountType:"CASH",cutDay:1,paymentDay:1},{bankName:"Nu",accountType:"CREDIT",cutDay:1,paymentDay:10},{bankName:"Rappi",accountType:"CREDIT",cutDay:15,paymentDay:25},{bankName:"BBVA",accountType:"CREDIT",cutDay:5,paymentDay:20},{bankName:"Santander",accountType:"CREDIT",cutDay:10,paymentDay:25},{bankName:"Citibanamex",accountType:"CREDIT",cutDay:15,paymentDay:28}];this.loading.set(!0);let l=0,g=0;o.forEach((F,he)=>{let te=ne({userId:i,tenantId:e},F);this.paymentMethodService.createPaymentMethod(te).subscribe({next:()=>{l++,l+g===o.length&&(this.loading.set(!1),console.log(`\u2705 Creados ${l} m\xE9todos de pago predefinidos`),this.loadPaymentMethods())},error:xe=>{g++,console.error(`\u274C Error creando ${F.bankName}:`,xe),l+g===o.length&&(this.loading.set(!1),this.loadPaymentMethods())}})})}editPaymentMethod(i){this.selectedPaymentMethod.set(i),this.showForm.set(!0)}deletePaymentMethod(i){confirm(`\xBFEliminar la tarjeta "${i.bankName}"?`)&&this.paymentMethodService.deletePaymentMethod(i.id).subscribe({next:()=>{this.loadPaymentMethods()},error:e=>{console.error("Error deleting payment method:",e)}})}handleFormSave(){this.showForm.set(!1),this.loadPaymentMethods()}closeForm(){this.showForm.set(!1),this.selectedPaymentMethod.set(null)}getBankColor(i){let e={BBVA:"linear-gradient(135deg, #004481 0%, #0059A3 100%)",Santander:"linear-gradient(135deg, #EC0000 0%, #C40000 100%)",HSBC:"linear-gradient(135deg, #DB0011 0%, #B00010 100%)",Banamex:"linear-gradient(135deg, #002E6D 0%, #004B8D 100%)",Banorte:"linear-gradient(135deg, #ED1C24 0%, #C4161D 100%)",ScotiaBank:"linear-gradient(135deg, #ED1B2E 0%, #C41628 100%)",Inbursa:"linear-gradient(135deg, #003DA5 0%, #0052D9 100%)",default:"linear-gradient(135deg, #667EEA 0%, #764BA2 100%)"};return e[i]||e.default}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=O({type:t,selectors:[["app-payment-methods-tab"]],decls:6,vars:3,consts:[[1,"payment-methods-tab"],[1,"loading-container"],[1,"empty-state"],[1,"cards-grid"],["title","Agregar tarjeta",1,"fab"],[3,"paymentMethod"],[1,"spinner"],[1,"empty-icon"],[1,"button-group"],[1,"btn-primary",3,"click"],[1,"icon"],[1,"btn-secondary",3,"click"],["class","credit-card",3,"background",4,"ngIf"],["class","cash-card",4,"ngIf"],[1,"credit-card"],[1,"card-chip"],["width","40","height","32","viewBox","0 0 40 32","fill","none"],["width","40","height","32","rx","4","fill","url(#chip-gradient)"],["id","chip-gradient","x1","0","y1","0","x2","40","y2","32"],["offset","0%","stop-color","#FFD700"],["offset","100%","stop-color","#FFA500"],[1,"card-actions"],["title","Editar",1,"btn-card-icon",3,"click"],[3,"img","size"],["title","Eliminar",1,"btn-card-icon",3,"click"],[1,"card-body"],[1,"card-alias"],[1,"card-number"],[1,"card-info"],[1,"card-holder"],[1,"label"],[1,"value"],[1,"card-type"],["class","card-footer",4,"ngIf"],[1,"card-footer"],[1,"payment-info"],[1,"info-item"],[1,"info-label"],[1,"info-value"],[1,"cash-card"],[1,"cash-icon"],[1,"cash-info"],[1,"cash-title"],[1,"cash-description"],["title","Agregar tarjeta",1,"fab",3,"click"],[1,"fab-icon"],[3,"save","cancel","paymentMethod"]],template:function(e,o){e&1&&(n(0,"div",0),h(1,He,4,0,"div",1)(2,We,16,0,"div",2)(3,et,3,0,"div",3),h(4,tt,3,0,"button",4),h(5,nt,1,1,"app-payment-method-form",5),a()),e&2&&(r(),x(o.loading()?1:o.paymentMethods().length===0?2:3),r(3),x(o.paymentMethods().length>0&&!o.loading()?4:-1),r(),x(o.showForm()?5:-1))},dependencies:[E,N,Z,D,S],styles:['.payment-methods-tab[_ngcontent-%COMP%]{position:relative;min-height:400px}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 2rem;color:#6e6e73}.loading-container[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:48px;height:48px;border:4px solid rgba(0,122,255,.1);border-top-color:#007aff;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:1rem;font-size:.9375rem}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 2rem;text-align:center}.empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:1rem;opacity:.6}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;color:#1d1d1f;margin:0 0 .5rem}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9375rem;color:#6e6e73;margin:0 0 2rem;max-width:400px}.empty-state[_ngcontent-%COMP%]   .button-group[_ngcontent-%COMP%]{display:flex;gap:1rem;flex-wrap:wrap;justify-content:center}.empty-state[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;padding:.875rem 1.75rem;color:#fff;border:none;border-radius:12px;font-size:.9375rem;font-weight:600;cursor:pointer;transition:all .3s ease}.empty-state[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:1.25rem}.empty-state[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover, .empty-state[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.empty-state[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:active, .empty-state[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]:active{transform:translateY(0)}.empty-state[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#007aff,#0051d5);box-shadow:0 4px 12px #007aff4d}.empty-state[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover{box-shadow:0 6px 20px #007aff66}.empty-state[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#af52de,#8e44ad);box-shadow:0 4px 12px #8e44ad4d}.empty-state[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]:hover{box-shadow:0 6px 20px #8e44ad66}.cards-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(360px,1fr));gap:2rem;animation:_ngcontent-%COMP%_fadeIn .4s ease-out}.credit-card[_ngcontent-%COMP%]{position:relative;width:100%;aspect-ratio:1.586;padding:1.75rem;border-radius:20px;color:#fff;box-shadow:0 10px 40px #0003,0 2px 8px #0000001a,inset 0 1px #fff3;transition:all .4s cubic-bezier(.4,0,.2,1);cursor:pointer;overflow:hidden}.credit-card[_ngcontent-%COMP%]:before{content:"";position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:radial-gradient(circle at 30% 30%,rgba(255,255,255,.15) 0%,transparent 60%);pointer-events:none}.credit-card[_ngcontent-%COMP%]:hover{transform:translateY(-8px) scale(1.02);box-shadow:0 20px 60px #0000004d,0 4px 16px #00000026,inset 0 1px #ffffff40}.credit-card[_ngcontent-%COMP%]   .card-chip[_ngcontent-%COMP%]{margin-bottom:1.5rem;animation:_ngcontent-%COMP%_shimmer 3s ease-in-out infinite}.credit-card[_ngcontent-%COMP%]   .card-actions[_ngcontent-%COMP%]{position:absolute;top:1.75rem;right:1.75rem;display:flex;gap:.5rem;opacity:0;transition:opacity .3s ease}.credit-card[_ngcontent-%COMP%]:hover   .card-actions[_ngcontent-%COMP%]{opacity:1}.credit-card[_ngcontent-%COMP%]   .btn-card-icon[_ngcontent-%COMP%]{width:36px;height:36px;display:flex;align-items:center;justify-content:center;background:#fff3;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.3);border-radius:10px;cursor:pointer;transition:all .2s ease;font-size:.875rem}.credit-card[_ngcontent-%COMP%]   .btn-card-icon[_ngcontent-%COMP%]:hover{background:#ffffff4d;transform:scale(1.1)}.credit-card[_ngcontent-%COMP%]   .btn-card-icon[_ngcontent-%COMP%]:active{transform:scale(.95)}.credit-card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.credit-card[_ngcontent-%COMP%]   .card-alias[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:600;letter-spacing:.02em;text-shadow:0 2px 4px rgba(0,0,0,.2);margin-bottom:-.5rem;opacity:.95}.credit-card[_ngcontent-%COMP%]   .card-number[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:500;letter-spacing:.15em;text-shadow:0 2px 4px rgba(0,0,0,.2);font-family:SF Mono,Courier New,monospace}.credit-card[_ngcontent-%COMP%]   .card-info[_ngcontent-%COMP%]{display:flex;gap:2rem}.credit-card[_ngcontent-%COMP%]   .card-holder[_ngcontent-%COMP%], .credit-card[_ngcontent-%COMP%]   .card-type[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.credit-card[_ngcontent-%COMP%]   .card-holder[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%], .credit-card[_ngcontent-%COMP%]   .card-type[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:.6875rem;text-transform:uppercase;letter-spacing:.08em;opacity:.8;font-weight:500}.credit-card[_ngcontent-%COMP%]   .card-holder[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%], .credit-card[_ngcontent-%COMP%]   .card-type[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;text-shadow:0 1px 2px rgba(0,0,0,.2)}.credit-card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]{position:absolute;bottom:1.75rem;left:1.75rem;right:1.75rem;display:flex;justify-content:space-between;align-items:flex-end}.credit-card[_ngcontent-%COMP%]   .payment-info[_ngcontent-%COMP%]{display:flex;gap:1.5rem}.credit-card[_ngcontent-%COMP%]   .payment-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.credit-card[_ngcontent-%COMP%]   .payment-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .info-label[_ngcontent-%COMP%]{font-size:.625rem;text-transform:uppercase;letter-spacing:.08em;opacity:.8;font-weight:500}.credit-card[_ngcontent-%COMP%]   .payment-info[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .info-value[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;text-shadow:0 1px 2px rgba(0,0,0,.2)}.credit-card[_ngcontent-%COMP%]   .card-status[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;width:28px;height:28px;background:#fff3;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.3);border-radius:50%;font-size:.875rem;font-weight:600}.credit-card[_ngcontent-%COMP%]   .card-status[_ngcontent-%COMP%]   .status-badge.active[_ngcontent-%COMP%]{background:#34c7594d;border-color:#34c75980}.credit-card[_ngcontent-%COMP%]   .card-status[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]:not(.active){background:#ff3b304d;border-color:#ff3b3080}.fab[_ngcontent-%COMP%]{position:fixed;bottom:2rem;right:2rem;width:64px;height:64px;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#007aff,#0051d5);border:none;border-radius:50%;box-shadow:0 8px 24px #007aff66,0 2px 8px #0000001f;cursor:pointer;transition:all .3s cubic-bezier(.4,0,.2,1);z-index:100}.fab[_ngcontent-%COMP%]   .fab-icon[_ngcontent-%COMP%]{font-size:2rem;font-weight:300;color:#fff;line-height:1}.fab[_ngcontent-%COMP%]:hover{transform:scale(1.1) rotate(90deg);box-shadow:0 12px 32px #007aff80,0 4px 12px #00000029}.fab[_ngcontent-%COMP%]:active{transform:scale(1.05) rotate(90deg)}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_shimmer{0%,to{opacity:1}50%{opacity:.8}}@media(max-width:768px){.cards-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.fab[_ngcontent-%COMP%]{bottom:1.5rem;right:1.5rem;width:56px;height:56px}.fab[_ngcontent-%COMP%]   .fab-icon[_ngcontent-%COMP%]{font-size:1.75rem}}.cash-card[_ngcontent-%COMP%]{background-color:#f9f9f9;color:#333;border:1px solid #ddd;border-radius:8px;padding:16px;display:flex;align-items:center;gap:16px;transition:transform .2s ease,box-shadow .2s ease;cursor:pointer}.cash-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 4px 8px #0000001a}.cash-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background-color:#e0e0e0;border-radius:50%;width:48px;height:48px}.cash-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700;margin:0}.cash-description[_ngcontent-%COMP%]{font-size:.875rem;color:#666;margin:0}']})};function ot(t,i){t&1&&m(0,"app-categories-tab")}function it(t,i){t&1&&m(0,"app-payment-methods-tab")}var be=class t{activeTab=_("categories");Folder=V;CreditCard=ce;switchTab(i){this.activeTab.set(i)}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=O({type:t,selectors:[["app-settings"]],decls:20,vars:11,consts:[[1,"settings-container"],[1,"settings-header"],[1,"subtitle"],[1,"tabs-container"],[1,"tab-selector"],[1,"tab-button",3,"click"],[3,"img","size"],[1,"tab-label"],[1,"tab-indicator"],[1,"tab-content"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"header",1)(2,"h1"),c(3,"Ajustes"),a(),n(4,"p",2),c(5,"Gestiona categor\xEDas y m\xE9todos de pago"),a()(),n(6,"div",3)(7,"div",4)(8,"button",5),p("click",function(){return o.switchTab("categories")}),m(9,"lucide-icon",6),n(10,"span",7),c(11,"Categor\xEDas"),a()(),n(12,"button",5),p("click",function(){return o.switchTab("payment-methods")}),m(13,"lucide-icon",6),n(14,"span",7),c(15,"M\xE9todos de Pago"),a()(),m(16,"div",8),a()(),n(17,"div",9),h(18,ot,1,0,"app-categories-tab")(19,it,1,0,"app-payment-methods-tab"),a()()),e&2&&(r(8),y("active",o.activeTab()==="categories"),r(),d("img",o.Folder)("size",18),r(3),y("active",o.activeTab()==="payment-methods"),r(),d("img",o.CreditCard)("size",18),r(3),y("right",o.activeTab()==="payment-methods"),r(2),x(o.activeTab()==="categories"?18:19))},dependencies:[E,Q,ee,D,S],styles:[".settings-container[_ngcontent-%COMP%]{padding:2rem;max-width:1200px;margin:0 auto;animation:_ngcontent-%COMP%_fadeIn .4s ease-out}.settings-header[_ngcontent-%COMP%]{margin-bottom:2rem}.settings-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:700;color:#1d1d1f;margin:0 0 .5rem;letter-spacing:-.02em}.settings-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-size:1rem;color:#6e6e73;margin:0}.tabs-container[_ngcontent-%COMP%]{margin-bottom:2rem}.tab-selector[_ngcontent-%COMP%]{position:relative;display:flex;background:#ffffffd9;backdrop-filter:blur(20px);-webkit-backdrop-filter:blur(20px);border-radius:14px;padding:4px;box-shadow:0 2px 8px #0000000a;border:1px solid rgba(255,255,255,.18)}.tab-button[_ngcontent-%COMP%]{position:relative;flex:1;display:flex;align-items:center;justify-content:center;gap:.5rem;padding:.875rem 1.5rem;background:transparent;border:none;border-radius:10px;font-size:.9375rem;font-weight:600;color:#6e6e73;cursor:pointer;transition:all .3s cubic-bezier(.4,0,.2,1);z-index:2}.tab-button[_ngcontent-%COMP%]   lucide-icon[_ngcontent-%COMP%]{transition:transform .3s ease;color:inherit}.tab-button[_ngcontent-%COMP%]   .tab-label[_ngcontent-%COMP%]{transition:color .3s ease}.tab-button[_ngcontent-%COMP%]:hover{color:#1d1d1f}.tab-button[_ngcontent-%COMP%]:hover   lucide-icon[_ngcontent-%COMP%]{transform:scale(1.1)}.tab-button.active[_ngcontent-%COMP%]{color:#007aff}.tab-button.active[_ngcontent-%COMP%]   lucide-icon[_ngcontent-%COMP%]{transform:scale(1.15)}.tab-indicator[_ngcontent-%COMP%]{position:absolute;top:4px;left:4px;width:calc(50% - 4px);height:calc(100% - 8px);background:#fff;border-radius:10px;box-shadow:0 2px 8px #00000014,0 1px 2px #0000000a;transition:transform .3s cubic-bezier(.4,0,.2,1);z-index:1}.tab-indicator.right[_ngcontent-%COMP%]{transform:translate(calc(100% + 4px))}.tab-content[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideIn .3s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translate(-10px)}to{opacity:1;transform:translate(0)}}@media(max-width:768px){.settings-container[_ngcontent-%COMP%]{padding:1rem}.settings-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem}.tab-button[_ngcontent-%COMP%]{flex-direction:column;gap:.25rem;padding:.75rem 1rem}.tab-button[_ngcontent-%COMP%]   lucide-icon[_ngcontent-%COMP%]{width:20px;height:20px}.tab-button[_ngcontent-%COMP%]   .tab-label[_ngcontent-%COMP%]{font-size:.75rem}}"]})};export{be as SettingsComponent};
