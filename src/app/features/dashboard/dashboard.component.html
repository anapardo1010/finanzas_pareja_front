<div class="dashboard-container">
  <header class="dashboard-header">
    <div class="welcome">
      <h1>Hola, {{ userName() }} ðŸ‘‹</h1>
      <p class="subtitle">Este es el estado de tus finanzas hoy.</p>
    </div>
    <button class="btn-primary" (click)="navigateTo('/main/transactions')">
      <lucide-icon [img]="icons.Plus" [size]="18"></lucide-icon>
      Nueva TransacciÃ³n
    </button>
  </header>

  <div class="bento-grid">
    <div class="bento-item main-balance">
      <span class="card-label">Balance Total</span>
      <div class="main-value">{{ comparison().current | currency:'USD' }}</div>
      <div class="comparison" [class.up]="comparison().isPositive" [class.down]="!comparison().isPositive">
        <lucide-icon [img]="comparison().isPositive ? icons.TrendingUp : icons.TrendingDown" [size]="14"></lucide-icon>
        <span>{{ comparison().percent | number:'1.1-1' }}% vs mes anterior</span>
      </div>
    </div>

    <div class="bento-item stat-card income">
      <div class="icon-box"><lucide-icon [img]="icons.TrendingUp" [size]="24"></lucide-icon></div>
      <div class="details">
        <span class="card-label">Ingresos</span>
        <span class="value">{{ summary().income | currency:'USD' }}</span>
      </div>
    </div>

    <div class="bento-item stat-card expense">
      <div class="icon-box"><lucide-icon [img]="icons.TrendingDown" [size]="24"></lucide-icon></div>
      <div class="details">
        <span class="card-label">Gastos</span>
        <span class="value">{{ summary().expense | currency:'USD' }}</span>
      </div>
    </div>

    <div class="bento-item stat-card msi">
      <div class="icon-box"><lucide-icon [img]="icons.Calendar" [size]="24"></lucide-icon></div>
      <div class="details">
        <span class="card-label">PrÃ³ximas Cuotas</span>
        <span class="value">{{ upcomingInstallments().length }} pendientes</span>
      </div>
    </div>

    <div class="bento-item categories-chart compact">
  <div class="card-header">
    <h3>Top 10 Gastos por CategorÃ­a</h3>
  </div>
  
  <div class="bars-container scroll-optimized">
    @for (cat of topCategories(); track cat.name; let i = $index) {
      <div class="category-row-compact">
        <div class="cat-data">
          <span class="cat-name">{{ cat.name }}</span>
          <span class="cat-amount">{{ cat.amount | currency:'USD':'symbol':'1.0-0' }}</span>
        </div>
        <div class="progress-container">
          <div class="progress-bg-mini">
            <div class="progress-fill" 
                 [style.width.%]="cat.percentage"
                 [ngClass]="'bar-color-' + (i % 4)">
            </div>
          </div>
          <span class="cat-percent">{{ cat.percentage | number:'1.0-0' }}%</span>
        </div>
      </div>
    } @empty {
      <p class="empty-txt">No hay gastos este mes.</p>
    }
  </div>
</div>
  </div>
</div>